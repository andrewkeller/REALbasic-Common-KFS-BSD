<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 TRANSITIONAL//EN">
<html>
	<head>
		<title>MainThreadInvokerKFS - REALbasic Common KFS BSD Library Documentation</title>
		<link rel="stylesheet" href="../../style.css">
	</head>
	<body>
		<h1>REALbasic Common KFS BSD Library Documentation</h1>
		<div id="tnb" class="hlinks">
			<a href="../../index.html">Index</a>
			<a class="act">Core</a>
			<a href="../../download.html">Download</a>
			<a href="../../usingwithvc.html">Using with Git</a>
			<a href="../../usingwithrb.html">Using with REAL Studio</a>
		</div>
		<div class=docblock>
			<h2>MainThreadInvokerKFS <span class=cd>(Inherits from Object)</span></h2>
			<p>This class is used to invoke a method in the main thread.</p>
			
			<h2>Delegates</h2>
			<div class="attrlist">
				<div class="unit">
					<h1>PlainMethod</h1>
					<h2>Sub PlainMethod()</h2>
					<p>The signature of methods that this class can invoke.</p>
				</div>
			</div>
			
			<h2>Constructors</h2>
			<div class="attrlist">
				<div class="unit">
					<h1>PlainMethod, Integer = 0</h1>
					<h2>New MainThreadInvokerKFS( d As PlainMethod, delay As Integer = 0 )</h1>
					<p>Sets up a new MainThreadInvokerKFS object to invoke the given method after the given delay (milliseconds).  The object can be orphaned until the main thread runs the target method, at which point the object deallocates according to normal REALbasic rules.</p>
				</div>
			</div>
			
			<h2>Methods</h2>
			<div class="attrlist">
				<div class="unit">
					<h1>Cancel</h1>
					<h2>Cancel()</h1>
					<p>Cancels the intent to invoke the target method and disables orphaning.</p>
					<p>If the method has already been invoked, then this method does nothing.</p>
				</div>
				<div class="unit">
					<h1>Set</h1>
					<h2>Set( d As PlainMethod, delay As Integer )</h1>
					<p>Configures the object to invoke the given method after the given delay (milliseconds), and enables orphaning.  This destroys any previous configuration.</p>
					<p>Setting a new method to invoke does not imply that the method has been invoked.  The technique used in this class has some overhead, and even if the given delay is zero, a nonzero amount of time is required for the target method to get invoked.</p>
					<p>If you wish to run a whole bunch of methods in the main thread, do not use this method on one object repeatedly.  That will not work.  You must create a new MainThreadInvokerKFS object for each method you intend to invoke in the main thread.  Since this class allows orphaning, you can simply overwrite a single variable with a New MainThreadInvokerKFS( some_delegate ) repeatedly.</p>
				</div>
			</div>
			
			<h2>Properties</h2>
			<div class="attrlist">
				<div class="unit readonly">
					<h1>Delay</h1>
					<h2>Delay() As Integer</h1>
					<p>Returns the delay (milliseconds) that was specified when the object was set.  Returns zero if the object is not set.</p>
				</div>
				<div class="unit readonly">
					<h1>IsSet</h1>
					<h2>IsSet() As Boolean</h1>
					<p>Returns whether or not the object is currently set up to invoke a method.</p>
				</div>
				<div class="unit readonly">
					<h1>Target</h1>
					<h2>Target() As PlainMethod</h1>
					<p>Returns the current target delegate.  Returns Nil if the object is not set.</p>
				</div>
			</div>
			
			<h2>Compatibility</h2>
			<div>
				<p>This class is compatible with console applications, and should work on all platforms.</p>
				<p>This class is thread safe.</p>
				<p>This class is completely decoupled from the rest of this library.</p>
			</div>
			
			<h2>Notes</h2>
			<div>
				<p>A common trick used to invoke a method in the main thread is to set it as the Action of a Timer with a Period of zero, and run the Timer.  When the Timer goes off, the main thread handles the Action event, which runs the method.</p>
				<p>Unfortunately, even with a Period of zero, it takes a nonzero amount of time for the Timer to actually go off.  This amount of time is very small, but large enough that if the next instruction after running the Timer deallocates the Timer, then the Timer will get deallocated before it fires.</p>
				<p>The purpose of this class is simply to make sure that Timer does not deallocate before it goes off.  This class contains a Timer object, and uses a circular reference to prevent itself from getting deallocated.  When the Timer goes off, it destroys the circular reference, and invokes the target method.  At the conclusion of the method, if nothing else references the object, it is destroyed.</p>
			</div>
			
			<h2>See Also</h2>
			<div class="hlinks">
				<a href="http://docs.realsoftware.com/index.php/AddHandler">AddHandler</a>
				<a href="http://docs.realsoftware.com/index.php/AddressOf">AddressOf</a>
				<a href="../BSDGlobalsKFS_Logic/index.html">PlainMethodKFS</a>
				<a href="../BSDGlobalsKFS_Logic/index.html">InvokeInMainThreadKFS</a>
				<a href="http://docs.realsoftware.com/index.php/WeakAddressOf">WeakAddressOf</a>
			</div>
		</div>
	</body>
</html>
